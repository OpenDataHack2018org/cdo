@BeginModule
@NewPage
@Name      = Ensstat2
@Title     = Statistical values over an ensemble
@Section   = Statistical values
@Class     = Statistic
@Arguments = obsfile ensfiles ofile
@Operators = ensbrs enscrps

@BeginDescription
This module computes statistical values over an ensemble of input files.
Depending on the chosen operator the Brier score or Cumulative ranked 
probability score over all input files or a skill score is written to 
@file{ofile}. The date information of a time step in @file{ofile} is the date of the 
first input file.

All Operators in this module use @file{ifile1} as the reference (for instance 
an observation) whereas files @file{ifile2} - @file{ifilen} are understood as 
an ensemble consisting of n-1 members. 

For the Brier score it is assumed, that both @file{obsfile} and @file{ifiles} 
contain probability information. Usually in a way that @file{obsfile} is a 
mask indicating the occurence of an event and @file{ifiles} are forecast 
probabilities of the occurence of the event. Please also note below, that the 
'Brier Score' is actually defined as half the score which was originally 
defined by Brier. This is common practice for reasons of normalization. 

The cumulative ranked probability score is understood as the integral of the 
squared difference between the cumulative distribution function cdf(ensfiles(t,x)) 
of the ensemble and a heavyside function H(obsfile(t,x)). 
@EndDescription
@EndModule


@BeginOperator_ensbrs
@Title     = Brier score

@BeginDescription
@IfMan
o(t,x) = (i2(t,x)-i1(t,x))^2 + (i3(t,x)-i1(t,x))^2 + ... + (in(t,x)-i1(t,x))^2
@EndifMan
@IfDoc
@BeginMath
o(t,x) = \sum_{j=2}^{n} (i_j(t,x)-i_1(t,x))^2
@EndMath
@EndifDoc
@EndDescription
@EndOperator

@BeginOperator_enscrps
@Title     = Cumulative Ranked Probability score

@BeginDescription
@IfMan
o(t,x) = crps( {i1(t,x)}, {i2(t,x),...,in(t,x)} )
@EndifMan
@IfDoc
@BeginMath
o(t,x) = crps( \{i_1(t,x)\}, \{i_2(t,x),\ldots,i_n(t,x)\} )
@EndMath
@EndifDoc
@EndDescription
@EndOperator

@BeginExample
To compute the Brier score over 5 input files @file{ensfile1}-@file{ensfile5}
given an observation in @file{obsfile} use:
@BeginVerbatim
   cdo ensbrs obsfile ensfile1 ensfile2 ensfile3 ensfile4 ensfile5 ofile
@EndVerbatim
Or shorter with filename substitution:
@BeginVerbatim
   cdo ensbrs obsfile ensfile[1-5] ofile
@EndVerbatim
@EndExample
